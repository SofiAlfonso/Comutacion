<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Datos Raspberry</title>
    <link rel="icon" href="img/logo.png" type="image/png">
    <link rel="stylesheet" href="css/styles.css">
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-QWTKZyjpPEjISv5WaRU9OFeRpok6YctnYmDr5pNlyT2bRjXh0JMhjY6hW+ALEwIH" crossorigin="anonymous">
</head>
<body>
    <div class="title">
        <h1>Datos Raspberry</h1>
        <img src="img/logo.png" alt="Logo de Raspberry Pi">
    </div>
    <div class="container-master">
        <div class="container">
            <h2>Estado LED's 1 y 2</h2>
            <div class="button-container">
                <p id="led-1-status">
                    LED 1 está <strong>{{ 'encendido' if LED_STATES['LED1'] else 'apagado' }}</strong>.
                </p>
                <svg id="led-1-on-btn" xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-lightbulb" viewBox="0 0 16 16">
                    <path d="M2 6a6 6 0 1 1 10.174 4.31c-.203.196-.359.4-.453.619l-.762 1.769A.5.5 0 0 1 10.5 13a.5.5 0 0 1 0 1 .5.5 0 0 1 0 1l-.224.447a1 1 0 0 1-.894.553H6.618a1 1 0 0 1-.894-.553L5.5 15a.5.5 0 0 1 0-1 .5.5 0 0 1 0-1 .5.5 0 0 1-.46-.302l-.761-1.77a2 2 0 0 0-.453-.618A5.98 5.98 0 0 1 2 6m6-5a5 5 0 0 0-3.479 8.592c.263.254.514.564.676.941L5.83 12h4.342l.632-1.467c.162-.377.413-.687.676-.941A5 5 0 0 0 8 1"/>
                </svg>
                <svg id="led-1-off-btn" xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-lightbulb-off" viewBox="0 0 16 16">
                    <path fill-rule="evenodd" d="M2.23 4.35A6 6 0 0 0 2 6c0 1.691.7 3.22 1.826 4.31.203.196.359.4.453.619l.762 1.769A.5.5 0 0 0 5.5 13a.5.5 0 0 0 0 1 .5.5 0 0 0 0 1l.224.447a1 1 0 0 0 .894.553h2.764a1 1 0 0 0 .894-.553L10.5 15a.5.5 0 0 0 0-1 .5.5 0 0 0 0-1 .5.5 0 0 0 .288-.091L9.878 12H5.83l-.632-1.467a3 3 0 0 0-.676-.941 4.98 4.98 0 0 1-1.455-4.405zm1.588-2.653.708.707a5 5 0 0 1 7.07 7.07l.707.707a6 6 0 0 0-8.484-8.484zm-2.172-.051a.5.5 0 0 1 .708 0l12 12a.5.5 0 0 1-.708.708l-12-12a.5.5 0 0 1 0-.708"/>
                </svg>
            </div>
            <div class="button-container">
                <p id="led-2-status">
                    LED 2 está <strong>{{ 'encendido' if LED_STATES['LED2'] else 'apagado' }}</strong>.
                </p>
                <svg id="led-2-on-btn" xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-lightbulb" viewBox="0 0 16 16">
                    <path d="M2 6a6 6 0 1 1 10.174 4.31c-.203.196-.359.4-.453.619l-.762 1.769A.5.5 0 0 1 10.5 13a.5.5 0 0 1 0 1 .5.5 0 0 1 0 1l-.224.447a1 1 0 0 1-.894.553H6.618a1 1 0 0 1-.894-.553L5.5 15a.5.5 0 0 1 0-1 .5.5 0 0 1 0-1 .5.5 0 0 1-.46-.302l-.761-1.77a2 2 0 0 0-.453-.618A5.98 5.98 0 0 1 2 6m6-5a5 5 0 0 0-3.479 8.592c.263.254.514.564.676.941L5.83 12h4.342l.632-1.467c.162-.377.413-.687.676-.941A5 5 0 0 0 8 1"/>
                </svg>
                <svg id="led-2-off-btn" xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-lightbulb-off" viewBox="0 0 16 16">
                    <path fill-rule="evenodd" d="M2.23 4.35A6 6 0 0 0 2 6c0 1.691.7 3.22 1.826 4.31.203.196.359.4.453.619l.762 1.769A.5.5 0 0 0 5.5 13a.5.5 0 0 0 0 1 .5.5 0 0 0 0 1l.224.447a1 1 0 0 0 .894.553h2.764a1 1 0 0 0 .894-.553L10.5 15a.5.5 0 0 0 0-1 .5.5 0 0 0 0-1 .5.5 0 0 0 .288-.091L9.878 12H5.83l-.632-1.467a3 3 0 0 0-.676-.941 4.98 4.98 0 0 1-1.455-4.405zm1.588-2.653.708.707a5 5 0 0 1 7.07 7.07l.707.707a6 6 0 0 0-8.484-8.484zm-2.172-.051a.5.5 0 0 1 .708 0l12 12a.5.5 0 0 1-.708.708l-12-12a.5.5 0 0 1 0-.708"/>
                </svg>
            </div>
        </div>
        <div id="toast-container" class="toast-container position-fixed top-0 end-0 p-3">
            <!-- Los toasts se agregarán dinámicamente aquí -->
          </div>

        <div class="container">
            <h2>Intensidad Led 3</h2>
            <p id="led-3-status">
                LED 3 está a <strong><span id="led3Value">0</span>%</strong> de su intesidad.
            </p>
            <!-- Gráfica del LED 3 -->
            <div style="width: 80%; max-width: 500px; margin: 0 auto;">
                <canvas id="led3Bar"></canvas>
            </div>
        </div>

        <div class="container">
            <h2>Potenciómetro</h2>
            <p id="potentiometer-value">Valor del potenciómetro: <strong>{{ respuesta_potenciometro }}%</strong></p>

            <div class="progress">
                <div id="progress-bar" class="progress-bar" role="progressbar" style="width: 0%; background-color: #1377cf;" aria-valuenow="0" aria-valuemin="0" aria-valuemax="100">
                    0%
                </div>
            </div>
        </div>
    </div>

    <script src="script.js"></script>

    <script>
        // Inicializar la gráfica de LED 3 con Chart.js
        let led3BarChart;
        function initializeBarChart() {
            const ctx = document.getElementById('led3Bar').getContext('2d');
            led3BarChart = new Chart(ctx, {
                type: 'bar',
                data: {
                    labels: ['Intensidad'],
                    datasets: [{
                        label: 'Nivel de Intensidad',
                        data: [0], // Se actualizará en tiempo real
                        backgroundColor: '#1377cf',
                        borderColor: '#1377cf',
                        borderWidth: 1
                    }]
                },
                options: {
                    indexAxis: 'y', // Hace la barra horizontal
                    scales: {
                        x: {
                            max: 100, // Máximo valor del potenciómetro
                            beginAtZero: true
                        },
                        y: {
                            display: false // Oculta el eje Y
                        }
                    },
                    plugins: {
                        legend: { display: false },
                        tooltip: { enabled: false }
                    },
                    responsive: true,
                    maintainAspectRatio: false
                }
            });
        }

        // Función para actualizar la gráfica de LED 3 en base al valor real
        function updateBarChart(value) {
            if (led3BarChart) {
                led3BarChart.data.datasets[0].data[0] = value; // Actualiza el valor de la barra
                led3BarChart.update();
                document.getElementById('led3Value').innerText = value;
            }
        }

        // Llama a la inicialización de la gráfica al cargar la página
        document.addEventListener('DOMContentLoaded', function() {
            initializeBarChart();
            // Simulación de cambio de valor cada segundo
            setInterval(() => {
                const simulatedValue = Math.floor(Math.random() * 101); // Cambia este valor por el valor real de LED 3
                updateBarChart(simulatedValue);
            }, 1000);
        });
    </script>

     <!-- JavaScript para simular la actualización de la barra de progreso -->
     <script>
        // Función para simular el valor de progreso
        function fetchProgress() {
            // Simulación: Genera un valor aleatorio entre 0 y 100
            const value = Math.floor(Math.random() * 101);  // Cambia este valor para probar con un valor específico

            const progressBar = document.getElementById('progress-bar');
            const potentiometerValue = document.getElementById('potentiometer-value');

            // Actualizar la barra de progreso y el texto
            progressBar.style.width = value + '%';
            progressBar.setAttribute('aria-valuenow', value);
            progressBar.textContent = value + '%';
            potentiometerValue.textContent = 'Valor del potenciómetro: ' + value + '%';
        }

        // Llamar a la función cada cierto tiempo (por ejemplo, cada 2 segundos)
        setInterval(fetchProgress, 2000);
    </script>
     <!-- Añadimos el script de la página -->
     <script src="js/script.js"></script>
     <!-- Añadimos Chart.js desde CDN -->
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <!-- Añadimos boostrap -->
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js" integrity="sha384-YvpcrYf0tY3lHB60NNkmXc5s9fDVZLESaAA55NDzOxhy9GkcIdslK1eN7N6jIeHz" crossorigin="anonymous"></script>
</body>
</html>
</body>
</html>
